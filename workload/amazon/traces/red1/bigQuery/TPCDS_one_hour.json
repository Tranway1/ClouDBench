{"queries": [{"id": "30", "start_time": "2023-03-27T13:45:02.704060+00:00", "text": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from tpcds_1.item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from tpcds_1.web_sales, tpcds_1.date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from tpcds_1.catalog_sales, tpcds_1.date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from tpcds_1.store_sales, tpcds_1.date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 ) tmp,tpcds_1.time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;"}, {"id": "6", "start_time": "2023-03-27T13:49:48.384051+00:00", "text": "select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1212 and 1212+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nLIMIT 100;"}, {"id": "13", "start_time": "2023-03-27T13:56:11.035457+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "22", "start_time": "2023-03-27T13:56:19.280722+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "2", "start_time": "2023-03-27T14:00:38.897175+00:00", "text": "select  *\nfrom\n (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "26", "start_time": "2023-03-27T14:01:10.624925+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "27", "start_time": "2023-03-27T14:01:10.624925+00:00", "text": "select   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  avg(cd_dep_count),\n  max(cd_dep_count),\n  sum(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  avg(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  sum(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  avg(cd_dep_college_count),\n  max(cd_dep_college_count),\n  sum(cd_dep_college_count)\n from\n  tpcds_1.customer c,tpcds_1.customer_address ca,tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   (exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4) or \n    exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4))\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n LIMIT 100;"}, {"id": "15", "start_time": "2023-03-27T14:01:31.373181+00:00", "text": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\n tpcds_1.item i1,\n tpcds_1.item i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nLIMIT 100;"}, {"id": "16", "start_time": "2023-03-27T14:03:11.536285+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "7", "start_time": "2023-03-27T14:04:24.549003+00:00", "text": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from tpcds_1.item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from tpcds_1.web_sales, tpcds_1.date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from tpcds_1.catalog_sales, tpcds_1.date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from tpcds_1.store_sales, tpcds_1.date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 ) tmp, tpcds_1.time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;"}, {"id": "17", "start_time": "2023-03-27T14:15:04.381203+00:00", "text": "select   \n         w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n        ,ship_carriers\n        ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n     select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers\n       ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net\n     from\n          tpcds_1.web_sales, tpcds_1.warehouse, tpcds_1.date_dim, tpcds_1.time_dim, tpcds_1.ship_mode\n     where\n            ws_warehouse_sk =  w_warehouse_sk\n        and ws_sold_date_sk = d_date_sk\n        and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n        and d_year = 2002\n \tand t_time between 49530 and 49530+28800 \n \tand sm_carrier in ('DIAMOND','AIRBORNE')\n     group by \n        w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n       ,d_year\n union all\n     select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers\n       ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net\n     from\n          tpcds_1.catalog_sales, tpcds_1.warehouse, tpcds_1.date_dim, tpcds_1.time_dim, tpcds_1.ship_mode\n     where\n            cs_warehouse_sk =  w_warehouse_sk\n        and cs_sold_date_sk = d_date_sk\n        and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n        and d_year = 2002\n \tand t_time between 49530 AND 49530+28800 \n \tand sm_carrier in ('DIAMOND','AIRBORNE')\n     group by \n        w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n       ,d_year\n ) x\n group by \n        w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n       ,year\n order by w_warehouse_name\n LIMIT 100;"}, {"id": "24", "start_time": "2023-03-27T14:16:02.343340+00:00", "text": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\ntpcds_1.item i1,\ntpcds_1.item i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nLIMIT 100;"}, {"id": "8", "start_time": "2023-03-27T14:20:13.565513+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dj,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc;"}, {"id": "28", "start_time": "2023-03-27T14:22:02.977802+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "4", "start_time": "2023-03-27T14:26:34.081004+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "25", "start_time": "2023-03-27T14:26:47.976510+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "14", "start_time": "2023-03-27T14:27:29.312429+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "11", "start_time": "2023-03-27T14:30:18.674111+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "9", "start_time": "2023-03-27T14:30:49.413884+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "23", "start_time": "2023-03-27T14:30:57.946550+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "19", "start_time": "2023-03-27T14:31:00.431616+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "29", "start_time": "2023-03-27T14:31:01.171059+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "12", "start_time": "2023-03-27T14:31:02.127920+00:00", "text": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\n tpcds_1.item i1,\n tpcds_1.item i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nLIMIT 100;"}, {"id": "3", "start_time": "2023-03-27T14:32:45.905529+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "10", "start_time": "2023-03-27T14:35:57.897769+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "1", "start_time": "2023-03-27T14:38:08.512409+00:00", "text": "with v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from tpcds_1.item, tpcds_1.catalog_sales, tpcds_1.date_dim, tpcds_1.call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2000 or\n         ( d_year = 2000-1 and d_moy =12) or\n         ( d_year = 2000+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2000 and\n        avg_monthly_sales > 0 and\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n LIMIT 100;"}, {"id": "21", "start_time": "2023-03-27T14:38:36.062976+00:00", "text": "with year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from tpcds_1.customer, tpcds_1.store_sales, tpcds_1.date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001,2001+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from tpcds_1.customer, tpcds_1.web_sales, tpcds_1.date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001,2001+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 2001\n         and t_s_secyear.year = 2001+1\n         and t_w_firstyear.year = 2001\n         and t_w_secyear.year = 2001+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,1,3\nLIMIT 100;"}, {"id": "18", "start_time": "2023-03-27T14:40:31.853510+00:00", "text": "select  *\nfrom\n (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "0", "start_time": "2023-03-27T14:42:42.411446+00:00", "text": "select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1212 and 1212+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nLIMIT 100;"}, {"id": "20", "start_time": "2023-03-27T14:43:41.957896+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}]}