{"queries": [{"id": "1", "start_time": "2023-03-27T13:03:48.554857+00:00", "text": "with ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom tpcds_1.store_sales, tpcds_1.store_returns, tpcds_1.store, tpcds_1.item, tpcds_1.customer, tpcds_1.customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=7\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'orchid'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\n;"}, {"id": "109", "start_time": "2023-03-27T13:05:10.513769+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "48", "start_time": "2023-03-27T13:07:02.744157+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "64", "start_time": "2023-03-27T13:07:48.223308+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200),\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "130", "start_time": "2023-03-27T13:07:57.205827+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "105", "start_time": "2023-03-27T13:07:57.598835+00:00", "text": "select  dt.d_year \n       ,item.i_brand_id brand_id \n       ,item.i_brand brand\n       ,sum(ss_ext_sales_price) sum_agg\n from  tpcds_1.date_dim dt \n      ,tpcds_1.store_sales\n      ,tpcds_1.item\n where dt.d_date_sk = store_sales.ss_sold_date_sk\n   and store_sales.ss_item_sk = item.i_item_sk\n   and item.i_manufact_id = 436\n   and dt.d_moy=12\n group by dt.d_year\n      ,item.i_brand\n      ,item.i_brand_id\n order by dt.d_year\n         ,sum_agg desc\n         ,brand_id\n LIMIT 100;"}, {"id": "153", "start_time": "2023-03-27T13:08:03.517067+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "157", "start_time": "2023-03-27T13:08:52.848609+00:00", "text": "select  dt.d_year \n       ,item.i_brand_id brand_id \n       ,item.i_brand brand\n       ,sum(ss_ext_sales_price) sum_agg\n from  tpcds_1.date_dim dt \n      ,tpcds_1.store_sales\n      ,tpcds_1.item\n where dt.d_date_sk = store_sales.ss_sold_date_sk\n   and store_sales.ss_item_sk = item.i_item_sk\n   and item.i_manufact_id = 436\n   and dt.d_moy=12\n group by dt.d_year\n      ,item.i_brand\n      ,item.i_brand_id\n order by dt.d_year\n         ,sum_agg desc\n         ,brand_id\n LIMIT 100;"}, {"id": "22", "start_time": "2023-03-27T13:09:02.362390+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "27", "start_time": "2023-03-27T13:09:05.541768+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "18", "start_time": "2023-03-27T13:09:08.367078+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "65", "start_time": "2023-03-27T13:09:13.262787+00:00", "text": "with v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from tpcds_1.item, tpcds_1.catalog_sales, tpcds_1.date_dim, tpcds_1.call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2000 or\n         ( d_year = 2000-1 and d_moy =12) or\n         ( d_year = 2000+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2000 and\n        avg_monthly_sales > 0 and\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n LIMIT 100;"}, {"id": "70", "start_time": "2023-03-27T13:09:16.651992+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "66", "start_time": "2023-03-27T13:10:30.292538+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "146", "start_time": "2023-03-27T13:11:03.300167+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "3", "start_time": "2023-03-27T13:11:06.085376+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "90", "start_time": "2023-03-27T13:11:15.723930+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn, tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "97", "start_time": "2023-03-27T13:11:20.110483+00:00", "text": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from tpcds_1.item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from tpcds_1.web_sales, tpcds_1.date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from tpcds_1.catalog_sales, tpcds_1.date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from tpcds_1.store_sales, tpcds_1.date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 ) tmp,tpcds_1.time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;"}, {"id": "111", "start_time": "2023-03-27T13:11:29.017728+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "26", "start_time": "2023-03-27T13:11:29.578136+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "156", "start_time": "2023-03-27T13:12:06.872456+00:00", "text": "select  s_store_name, s_store_id,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.store\n where d_date_sk = ss_sold_date_sk and\n       s_store_sk = ss_store_sk and\n       s_gmt_offset = -5 and\n       d_year = 1998 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n LIMIT 100;"}, {"id": "4", "start_time": "2023-03-27T13:12:11.175798+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "28", "start_time": "2023-03-27T13:12:14.270723+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "51", "start_time": "2023-03-27T13:12:16.766343+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "52", "start_time": "2023-03-27T13:12:48.982492+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "147", "start_time": "2023-03-27T13:12:56.256119+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "101", "start_time": "2023-03-27T13:13:15.331064+00:00", "text": "select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\n from tpcds_1.store_sales, tpcds_1.customer_demographics, tpcds_1.date_dim, tpcds_1.store, tpcds_1.item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       d_year = 1998 and\n       s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n LIMIT 100;"}, {"id": "9", "start_time": "2023-03-27T13:13:29.398581+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "77", "start_time": "2023-03-27T13:13:44.278004+00:00", "text": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from tpcds_1.item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from tpcds_1.web_sales, tpcds_1.date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from tpcds_1.catalog_sales, tpcds_1.date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from tpcds_1.store_sales, tpcds_1.date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 ) tmp,tpcds_1.time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;"}, {"id": "75", "start_time": "2023-03-27T13:13:51.939628+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "158", "start_time": "2023-03-27T13:13:53.582183+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "108", "start_time": "2023-03-27T13:14:19.583091+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "83", "start_time": "2023-03-27T13:14:25.427358+00:00", "text": "select  s_store_name, s_store_id,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.store\n where d_date_sk = ss_sold_date_sk and\n       s_store_sk = ss_store_sk and\n       s_gmt_offset = -5 and\n       d_year = 1998 \n group by s_store_name, s_store_id\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\n LIMIT 100;"}, {"id": "57", "start_time": "2023-03-27T13:14:29.309923+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "118", "start_time": "2023-03-27T13:14:32.596446+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "33", "start_time": "2023-03-27T13:14:42.320979+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "76", "start_time": "2023-03-27T13:15:02.116957+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "102", "start_time": "2023-03-27T13:17:50.326609+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dj,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc;"}, {"id": "34", "start_time": "2023-03-27T13:21:50.670012+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dj,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc;"}, {"id": "115", "start_time": "2023-03-27T13:25:34.005170+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "19", "start_time": "2023-03-27T13:27:25.165129+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "159", "start_time": "2023-03-27T13:45:02.704060+00:00", "text": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from tpcds_1.item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from tpcds_1.web_sales, tpcds_1.date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from tpcds_1.catalog_sales, tpcds_1.date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from tpcds_1.store_sales, tpcds_1.date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 ) tmp,tpcds_1.time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;"}, {"id": "29", "start_time": "2023-03-27T13:49:48.384051+00:00", "text": "select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1212 and 1212+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nLIMIT 100;"}, {"id": "67", "start_time": "2023-03-27T13:56:11.035457+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "116", "start_time": "2023-03-27T13:56:19.280722+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "12", "start_time": "2023-03-27T14:00:38.897175+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "134", "start_time": "2023-03-27T14:01:10.624925+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "135", "start_time": "2023-03-27T14:01:10.624925+00:00", "text": "select   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  avg(cd_dep_count),\n  max(cd_dep_count),\n  sum(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  avg(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  sum(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  avg(cd_dep_college_count),\n  max(cd_dep_college_count),\n  sum(cd_dep_college_count)\n from   tpcds_1.customer c, tpcds_1.customer_address ca, tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   (exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4) or \n    exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4))\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n LIMIT 100;"}, {"id": "73", "start_time": "2023-03-27T14:01:31.373181+00:00", "text": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\n tpcds_1.item i1,\n tpcds_1.item i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nLIMIT 100;"}, {"id": "74", "start_time": "2023-03-27T14:03:11.536285+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "38", "start_time": "2023-03-27T14:04:24.549003+00:00", "text": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from tpcds_1.item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from tpcds_1.web_sales, tpcds_1.date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from tpcds_1.catalog_sales, tpcds_1.date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from tpcds_1.store_sales, tpcds_1.date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2000\n                 ) tmp,tpcds_1.time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\n ;"}, {"id": "78", "start_time": "2023-03-27T14:15:04.381203+00:00", "text": "select   \n         w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n        ,ship_carriers\n        ,year\n \t,sum(jan_sales) as jan_sales\n \t,sum(feb_sales) as feb_sales\n \t,sum(mar_sales) as mar_sales\n \t,sum(apr_sales) as apr_sales\n \t,sum(may_sales) as may_sales\n \t,sum(jun_sales) as jun_sales\n \t,sum(jul_sales) as jul_sales\n \t,sum(aug_sales) as aug_sales\n \t,sum(sep_sales) as sep_sales\n \t,sum(oct_sales) as oct_sales\n \t,sum(nov_sales) as nov_sales\n \t,sum(dec_sales) as dec_sales\n \t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\n \t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\n \t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\n \t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\n \t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\n \t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\n \t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\n \t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\n \t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\n \t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\n \t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\n \t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\n \t,sum(jan_net) as jan_net\n \t,sum(feb_net) as feb_net\n \t,sum(mar_net) as mar_net\n \t,sum(apr_net) as apr_net\n \t,sum(may_net) as may_net\n \t,sum(jun_net) as jun_net\n \t,sum(jul_net) as jul_net\n \t,sum(aug_net) as aug_net\n \t,sum(sep_net) as sep_net\n \t,sum(oct_net) as oct_net\n \t,sum(nov_net) as nov_net\n \t,sum(dec_net) as dec_net\n from (\n     select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers\n       ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen ws_sales_price* ws_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen ws_sales_price* ws_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen ws_sales_price* ws_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2\n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net\n     from           tpcds_1.web_sales, tpcds_1.warehouse, tpcds_1.date_dim, tpcds_1.time_dim, tpcds_1.ship_mode\n     where\n            ws_warehouse_sk =  w_warehouse_sk\n        and ws_sold_date_sk = d_date_sk\n        and ws_sold_time_sk = t_time_sk\n \tand ws_ship_mode_sk = sm_ship_mode_sk\n        and d_year = 2002\n \tand t_time between 49530 and 49530+28800 \n \tand sm_carrier in ('DIAMOND','AIRBORNE')\n     group by \n        w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n       ,d_year\n union all\n     select \n \tw_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,'DIAMOND' || ',' || 'AIRBORNE' as ship_carriers\n       ,d_year as year\n \t,sum(case when d_moy = 1 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jan_sales\n \t,sum(case when d_moy = 2 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as feb_sales\n \t,sum(case when d_moy = 3 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as mar_sales\n \t,sum(case when d_moy = 4 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as apr_sales\n \t,sum(case when d_moy = 5 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as may_sales\n \t,sum(case when d_moy = 6 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jun_sales\n \t,sum(case when d_moy = 7 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as jul_sales\n \t,sum(case when d_moy = 8 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as aug_sales\n \t,sum(case when d_moy = 9 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as sep_sales\n \t,sum(case when d_moy = 10 \n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as oct_sales\n \t,sum(case when d_moy = 11\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as nov_sales\n \t,sum(case when d_moy = 12\n \t\tthen cs_ext_sales_price* cs_quantity else 0 end) as dec_sales\n \t,sum(case when d_moy = 1 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net\n \t,sum(case when d_moy = 2 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net\n \t,sum(case when d_moy = 3 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net\n \t,sum(case when d_moy = 4 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net\n \t,sum(case when d_moy = 5 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net\n \t,sum(case when d_moy = 6 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net\n \t,sum(case when d_moy = 7 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net\n \t,sum(case when d_moy = 8 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net\n \t,sum(case when d_moy = 9 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net\n \t,sum(case when d_moy = 10 \n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net\n \t,sum(case when d_moy = 11\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net\n \t,sum(case when d_moy = 12\n \t\tthen cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net\n     from           tpcds_1.catalog_sales, tpcds_1.warehouse, tpcds_1.date_dim, tpcds_1.time_dim, tpcds_1.ship_mode\n     where\n            cs_warehouse_sk =  w_warehouse_sk\n        and cs_sold_date_sk = d_date_sk\n        and cs_sold_time_sk = t_time_sk\n \tand cs_ship_mode_sk = sm_ship_mode_sk\n        and d_year = 2002\n \tand t_time between 49530 AND 49530+28800 \n \tand sm_carrier in ('DIAMOND','AIRBORNE')\n     group by \n        w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n       ,d_year\n ) x\n group by \n        w_warehouse_name\n \t,w_warehouse_sq_ft\n \t,w_city\n \t,w_county\n \t,w_state\n \t,w_country\n \t,ship_carriers\n       ,year\n order by w_warehouse_name\n LIMIT 100;"}, {"id": "119", "start_time": "2023-03-27T14:16:02.343340+00:00", "text": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\n tpcds_1.item i1,\n tpcds_1.item i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nLIMIT 100;"}, {"id": "41", "start_time": "2023-03-27T14:20:13.565513+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag \n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and date_dim.d_dom between 1 and 2 \n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and case when household_demographics.hd_vehicle_count > 0 then \n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dj,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 1 and 5\n    order by cnt desc, c_last_name asc;"}, {"id": "136", "start_time": "2023-03-27T14:22:02.977802+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "16", "start_time": "2023-03-27T14:26:34.081004+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "120", "start_time": "2023-03-27T14:26:47.976510+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "68", "start_time": "2023-03-27T14:27:29.312429+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "62", "start_time": "2023-03-27T14:30:18.674111+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "42", "start_time": "2023-03-27T14:30:49.413884+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "117", "start_time": "2023-03-27T14:30:57.946550+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "92", "start_time": "2023-03-27T14:31:00.431616+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "148", "start_time": "2023-03-27T14:31:01.171059+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "63", "start_time": "2023-03-27T14:31:02.127920+00:00", "text": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from tpcds_1.store_sales ss1\n                 where ss_store_sk = 2\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from tpcds_1.store_sales\n                                                  where ss_store_sk = 2\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\n tpcds_1.item i1,\n tpcds_1.item i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nLIMIT 100;"}, {"id": "14", "start_time": "2023-03-27T14:32:45.905529+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "58", "start_time": "2023-03-27T14:35:57.897769+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "10", "start_time": "2023-03-27T14:38:08.512409+00:00", "text": "with v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from tpcds_1.item, tpcds_1.catalog_sales, tpcds_1.date_dim, tpcds_1.call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2000 or\n         ( d_year = 2000-1 and d_moy =12) or\n         ( d_year = 2000+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2000 and\n        avg_monthly_sales > 0 and\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, nsum\n LIMIT 100;"}, {"id": "110", "start_time": "2023-03-27T14:38:36.062976+00:00", "text": "with year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from tpcds_1.customer, tpcds_1.store_sales, tpcds_1.date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001,2001+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from tpcds_1.customer, tpcds_1.web_sales, tpcds_1.date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001,2001+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 2001\n         and t_s_secyear.year = 2001+1\n         and t_w_firstyear.year = 2001\n         and t_w_secyear.year = 2001+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,1,3\nLIMIT 100;"}, {"id": "79", "start_time": "2023-03-27T14:40:31.853510+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "0", "start_time": "2023-03-27T14:42:42.411446+00:00", "text": "select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1212 and 1212+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nLIMIT 100;"}, {"id": "103", "start_time": "2023-03-27T14:43:41.957896+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "11", "start_time": "2023-03-27T14:47:48.443267+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "122", "start_time": "2023-03-27T14:51:06.513594+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "35", "start_time": "2023-03-27T14:51:08.001513+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "23", "start_time": "2023-03-27T14:51:35.468682+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "93", "start_time": "2023-03-27T14:51:36.956207+00:00", "text": "select sum (ss_quantity)\n from tpcds_1.store_sales, tpcds_1.store, tpcds_1.customer_demographics, tpcds_1.customer_address, tpcds_1.date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 1998\n and  \n (\n  (\n   cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'M'\n   and \n   cd_education_status = '4 yr Degree'\n   and \n   ss_sales_price between 100.00 and 150.00  \n   )\n or\n  (\n  cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'D'\n   and \n   cd_education_status = 'Primary'\n   and \n   ss_sales_price between 50.00 and 100.00   \n  )\n or \n (\n  cd_demo_sk = ss_cdemo_sk\n  and \n   cd_marital_status = 'U'\n   and \n   cd_education_status = 'Advanced Degree'\n   and \n   ss_sales_price between 150.00 and 200.00  \n )\n )\n and\n (\n  (\n  ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 0 and 2000  \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 3000 \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 25000 \n  )\n )\n;"}, {"id": "86", "start_time": "2023-03-27T14:52:30.688687+00:00", "text": "select  dt.d_year \n       ,item.i_brand_id brand_id \n       ,item.i_brand brand\n       ,sum(ss_ext_sales_price) sum_agg\n from  tpcds_1.date_dim dt \n      ,tpcds_1.store_sales\n      ,tpcds_1.item\n where dt.d_date_sk = store_sales.ss_sold_date_sk\n   and store_sales.ss_item_sk = item.i_item_sk\n   and item.i_manufact_id = 436\n   and dt.d_moy=12\n group by dt.d_year\n      ,item.i_brand\n      ,item.i_brand_id\n order by dt.d_year\n         ,sum_agg desc\n         ,brand_id\n LIMIT 100;"}, {"id": "5", "start_time": "2023-03-27T14:52:58.928630+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "43", "start_time": "2023-03-27T14:53:32.508236+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "15", "start_time": "2023-03-27T14:54:40.023162+00:00", "text": "with ws as\n  (select d_year AS ws_sold_year, ws_item_sk,\n    ws_bill_customer_sk     ws_customer_sk,\n    sum(ws_quantity) ws_qty,\n    sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp\n   from tpcds_1.web_sales\n   left join tpcds_1.web_returns on  wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\n   join tpcds_1.date_dim     on ws_sold_date_sk = d_date_sk\n   where wr_order_number is null\n   group by     d_year, ws_item_sk, ws_bill_customer_sk\n   ),\ncs as\n  (select d_year AS cs_sold_year,     cs_item_sk,\n    cs_bill_customer_sk cs_customer_sk,\n    sum(cs_quantity) cs_qty,\n        sum(cs_wholesale_cost) cs_wc,\n    sum(cs_sales_price) cs_sp\n   from tpcds_1.catalog_sales\n       left join tpcds_1.catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\n       join tpcds_1.date_dim on cs_sold_date_sk = d_date_sk\n   where cr_order_number is     null\n   group by d_year, cs_item_sk, cs_bill_customer_sk\n   ),\nss as\n  (select     d_year AS ss_sold_year, ss_item_sk,\n    ss_customer_sk,\n    sum(ss_quantity)     ss_qty,\n    sum(ss_wholesale_cost) ss_wc,\n    sum(ss_sales_price) ss_sp\n       from tpcds_1.store_sales\n   left join tpcds_1.store_returns on sr_ticket_number=ss_ticket_number     \n      and ss_item_sk=sr_item_sk\n   join tpcds_1.date_dim on ss_sold_date_sk = d_date_sk\n       where sr_ticket_number is null\n   group by d_year, ss_item_sk, ss_customer_sk\n      )\n select /* #WS3 RSPERF TPC-DS query78.tpl 1.26 */ \nss_customer_sk,\nround(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)     ratio,\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\n    coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\ncoalesce(ws_wc,0)+coalesce(cs_wc,0)    other_chan_wholesale_cost,\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\n    from ss\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk    and ws_customer_sk=ss_customer_sk)\nleft join cs on (cs_sold_year=ss_sold_year    and cs_item_sk=cs_item_sk and cs_customer_sk=ss_customer_sk)\nwhere coalesce(ws_qty,0)>0    and coalesce(cs_qty, 0)>0 \norder by \n  ss_customer_sk,\n  ss_qty desc, ss_wc\n     desc, ss_sp desc,\n  other_chan_qty,\n  other_chan_wholesale_cost,\n  other_chan_sales_price,\n     round(ss_qty/(coalesce(ws_qty+cs_qty,1)),2)\n;"}, {"id": "21", "start_time": "2023-03-27T14:57:09.295976+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "133", "start_time": "2023-03-27T14:57:28.158122+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "71", "start_time": "2023-03-27T15:04:55.171825+00:00", "text": "select  i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        avg( cast(cs_quantity as float64)) agg1,\n        avg( cast(cs_list_price as float64)) agg2,\n        avg( cast(cs_coupon_amt as float64)) agg3,\n        avg( cast(cs_sales_price as float64)) agg4,\n        avg( cast(cs_net_profit as float64)) agg5,\n        avg( cast(c_birth_year as float64)) agg6,\n        avg( cast(cd1.cd_dep_count as float64)) agg7\n from tpcds_1.catalog_sales, tpcds_1.customer_demographics cd1, \n      tpcds_1.customer_demographics cd2, tpcds_1.customer, tpcds_1.customer_address, tpcds_1.date_dim, tpcds_1.item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'College' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,12,4,1,10) and\n       d_year = 2001 and\n       ca_state in ('ND','WI','AL'\n                   ,'NC','OK','MS','TN')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state, \n        ca_county,\n\ti_item_id\n LIMIT 100;"}, {"id": "98", "start_time": "2023-03-27T15:05:48.250460+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "123", "start_time": "2023-03-27T15:08:29.691825+00:00", "text": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from   tpcds_1.customer c,tpcds_1.customer_address ca,tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','IL','MN') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n LIMIT 100;"}, {"id": "84", "start_time": "2023-03-27T15:09:57.452268+00:00", "text": "with ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom tpcds_1.store_sales, tpcds_1.store_returns, tpcds_1.store, tpcds_1.item, tpcds_1.customer, tpcds_1.customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=7\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'orchid'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\n;"}, {"id": "106", "start_time": "2023-03-27T15:11:30.279128+00:00", "text": "select  *\nfrom  (select count(*) h8_30_to_9\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk   \n     and ss_hdemo_sk = household_demographics.hd_demo_sk \n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 8\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \n     and store.s_store_name = 'ese') s1,\n (select count(*) h9_to_9_30 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 9 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s2,\n (select count(*) h9_30_to_10 \n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 9\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s3,\n (select count(*) h10_to_10_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s4,\n (select count(*) h10_30_to_11\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 10 \n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s5,\n (select count(*) h11_to_11_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk \n     and time_dim.t_hour = 11\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s6,\n (select count(*) h11_30_to_12\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 11\n     and time_dim.t_minute >= 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s7,\n (select count(*) h12_to_12_30\n from tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\n where ss_sold_time_sk = time_dim.t_time_sk\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\n     and ss_store_sk = s_store_sk\n     and time_dim.t_hour = 12\n     and time_dim.t_minute < 30\n     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or\n          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\n     and store.s_store_name = 'ese') s8\n;"}, {"id": "44", "start_time": "2023-03-27T15:12:26.096226+00:00", "text": "select  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 11 and 11+10 \n             or ss_coupon_amt between 460 and 460+1000\n             or ss_wholesale_cost between 14 and 14+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 91 and 91+10\n          or ss_coupon_amt between 1430 and 1430+1000\n          or ss_wholesale_cost between 32 and 32+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 66 and 66+10\n          or ss_coupon_amt between 920 and 920+1000\n          or ss_wholesale_cost between 4 and 4+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 142 and 142+10\n          or ss_coupon_amt between 3054 and 3054+1000\n          or ss_wholesale_cost between 80 and 80+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 135 and 135+10\n          or ss_coupon_amt between 14180 and 14180+1000\n          or ss_wholesale_cost between 38 and 38+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 28 and 28+10\n          or ss_coupon_amt between 2513 and 2513+1000\n          or ss_wholesale_cost between 42 and 42+20)) B6\nLIMIT 100;"}, {"id": "30", "start_time": "2023-03-27T15:13:35.248680+00:00", "text": "select  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 11 and 11+10 \n             or ss_coupon_amt between 460 and 460+1000\n             or ss_wholesale_cost between 14 and 14+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 91 and 91+10\n          or ss_coupon_amt between 1430 and 1430+1000\n          or ss_wholesale_cost between 32 and 32+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 66 and 66+10\n          or ss_coupon_amt between 920 and 920+1000\n          or ss_wholesale_cost between 4 and 4+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 142 and 142+10\n          or ss_coupon_amt between 3054 and 3054+1000\n          or ss_wholesale_cost between 80 and 80+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 135 and 135+10\n          or ss_coupon_amt between 14180 and 14180+1000\n          or ss_wholesale_cost between 38 and 38+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 28 and 28+10\n          or ss_coupon_amt between 2513 and 2513+1000\n          or ss_wholesale_cost between 42 and 42+20)) B6\nLIMIT 100;"}, {"id": "36", "start_time": "2023-03-27T15:14:47.749788+00:00", "text": "select  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 11 and 11+10 \n             or ss_coupon_amt between 460 and 460+1000\n             or ss_wholesale_cost between 14 and 14+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 91 and 91+10\n          or ss_coupon_amt between 1430 and 1430+1000\n          or ss_wholesale_cost between 32 and 32+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 66 and 66+10\n          or ss_coupon_amt between 920 and 920+1000\n          or ss_wholesale_cost between 4 and 4+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 142 and 142+10\n          or ss_coupon_amt between 3054 and 3054+1000\n          or ss_wholesale_cost between 80 and 80+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 135 and 135+10\n          or ss_coupon_amt between 14180 and 14180+1000\n          or ss_wholesale_cost between 38 and 38+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from tpcds_1.store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 28 and 28+10\n          or ss_coupon_amt between 2513 and 2513+1000\n          or ss_wholesale_cost between 42 and 42+20)) B6\nLIMIT 100;"}, {"id": "53", "start_time": "2023-03-27T15:15:20.495834+00:00", "text": "select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1212 and 1212+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nLIMIT 100;"}, {"id": "13", "start_time": "2023-03-27T15:18:29.090539+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "85", "start_time": "2023-03-27T15:19:34.298755+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "149", "start_time": "2023-03-27T15:20:41.847283+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "112", "start_time": "2023-03-27T15:23:26.638111+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "154", "start_time": "2023-03-27T15:26:48.247387+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "150", "start_time": "2023-03-27T15:26:55.069263+00:00", "text": "select avg(ss_quantity)\n       ,avg(ss_ext_sales_price)\n       ,avg(ss_ext_wholesale_cost)\n       ,sum(ss_ext_wholesale_cost)\n from tpcds_1.store_sales, tpcds_1.store, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.customer_address, tpcds_1.date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'D'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Secondary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'IL', 'MN')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('OH', 'MT', 'NM')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('TX', 'MO', 'MI')\n  and ss_net_profit between 50 and 250  \n     ))\n;"}, {"id": "160", "start_time": "2023-03-27T15:27:18.376330+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "37", "start_time": "2023-03-27T15:28:54.806610+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "137", "start_time": "2023-03-27T15:29:33.203625+00:00", "text": "select avg(ss_quantity)\n       ,avg(ss_ext_sales_price)\n       ,avg(ss_ext_wholesale_cost)\n       ,sum(ss_ext_wholesale_cost)\n from tpcds_1.store_sales, tpcds_1.store, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.customer_address, tpcds_1.date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'D'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Secondary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'IL', 'MN')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('OH', 'MT', 'NM')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('TX', 'MO', 'MI')\n  and ss_net_profit between 50 and 250  \n     ))\n;"}, {"id": "94", "start_time": "2023-03-27T15:32:38.586664+00:00", "text": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from   tpcds_1.customer c,tpcds_1.customer_address ca,tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','IL','MN') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n LIMIT 100;"}, {"id": "95", "start_time": "2023-03-27T15:32:38.586664+00:00", "text": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from   tpcds_1.customer c,tpcds_1.customer_address ca,tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','IL','MN') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n LIMIT 100;"}, {"id": "138", "start_time": "2023-03-27T15:32:54.311580+00:00", "text": "select avg(ss_quantity)\n       ,avg(ss_ext_sales_price)\n       ,avg(ss_ext_wholesale_cost)\n       ,sum(ss_ext_wholesale_cost)\n from tpcds_1.store_sales, tpcds_1.store, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.customer_address, tpcds_1.date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'D'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Secondary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'IL', 'MN')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('OH', 'MT', 'NM')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('TX', 'MO', 'MI')\n  and ss_net_profit between 50 and 250  \n     ))\n;"}, {"id": "49", "start_time": "2023-03-27T15:33:48.722809+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "104", "start_time": "2023-03-27T15:33:59.559448+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "6", "start_time": "2023-03-27T15:34:00.147220+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "145", "start_time": "2023-03-27T15:35:31.546655+00:00", "text": "with year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from tpcds_1.customer, tpcds_1.store_sales, tpcds_1.date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from tpcds_1.customer, tpcds_1.web_sales, tpcds_1.date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nLIMIT 100;"}, {"id": "45", "start_time": "2023-03-27T15:39:01.589012+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "131", "start_time": "2023-03-27T15:40:57.605986+00:00", "text": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from   tpcds_1.customer c,tpcds_1.customer_address ca,tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','IL','MN') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n LIMIT 100;"}, {"id": "132", "start_time": "2023-03-27T15:40:57.605986+00:00", "text": "select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from   tpcds_1.customer c,tpcds_1.customer_address ca,tpcds_1.customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','IL','MN') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from tpcds_1.store_sales, tpcds_1.date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from tpcds_1.web_sales, tpcds_1.date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from tpcds_1.catalog_sales, tpcds_1.date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n LIMIT 100;"}, {"id": "24", "start_time": "2023-03-27T15:42:15.652469+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "161", "start_time": "2023-03-27T15:42:23.500861+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "80", "start_time": "2023-03-27T15:42:57.880678+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "50", "start_time": "2023-03-27T15:43:33.304185+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "96", "start_time": "2023-03-27T15:43:36.211647+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "91", "start_time": "2023-03-27T15:45:39.515315+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "82", "start_time": "2023-03-27T15:45:58.695811+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "46", "start_time": "2023-03-27T15:46:03.340776+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "87", "start_time": "2023-03-27T15:47:28.858673+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "151", "start_time": "2023-03-27T15:48:52.720952+00:00", "text": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from    (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from tpcds_1.store_sales, tpcds_1.date_dim, tpcds_1.store, tpcds_1.household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '>10000' or\n         household_demographics.hd_buy_potential = 'Unknown')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County',\n                           'Williamson County','Williamson County','Williamson County','Williamson County')\n    group by ss_ticket_number,ss_customer_sk) dn,tpcds_1.customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;"}, {"id": "121", "start_time": "2023-03-27T15:50:24.843216+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "107", "start_time": "2023-03-27T15:52:34.702814+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "31", "start_time": "2023-03-27T15:52:51.133842+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "47", "start_time": "2023-03-27T15:53:01.142242+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "139", "start_time": "2023-03-27T15:53:02.301802+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "140", "start_time": "2023-03-27T15:53:02.301802+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "141", "start_time": "2023-03-27T15:53:02.301802+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "142", "start_time": "2023-03-27T15:53:02.301802+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "143", "start_time": "2023-03-27T15:53:02.301802+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "144", "start_time": "2023-03-27T15:53:02.301802+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "2", "start_time": "2023-03-27T15:53:13.817014+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "113", "start_time": "2023-03-27T15:53:20.517233+00:00", "text": "select case when (select count(*) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt) \n                  from tpcds_1.store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from tpcds_1.store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom tpcds_1.reason\nwhere r_reason_sk = 1\n;"}, {"id": "59", "start_time": "2023-03-27T15:53:42.634921+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "88", "start_time": "2023-03-27T15:53:44.861541+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "114", "start_time": "2023-03-27T15:54:01.642643+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "54", "start_time": "2023-03-27T15:54:05.981046+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "124", "start_time": "2023-03-27T15:54:09.693313+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "125", "start_time": "2023-03-27T15:54:09.693313+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "126", "start_time": "2023-03-27T15:54:09.693313+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "127", "start_time": "2023-03-27T15:54:09.693313+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "128", "start_time": "2023-03-27T15:54:09.693313+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "129", "start_time": "2023-03-27T15:54:09.693313+00:00", "text": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom tpcds_1.store_returns, tpcds_1.date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,tpcds_1.store\n, tpcds_1.customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'TN'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nLIMIT 100;"}, {"id": "72", "start_time": "2023-03-27T15:54:12.925559+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "8", "start_time": "2023-03-27T15:54:15.305258+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "81", "start_time": "2023-03-27T15:54:18.376490+00:00", "text": "select  i_brand_id brand_id, i_brand brand,\n \tsum(ss_ext_sales_price) ext_price\n from tpcds_1.date_dim, tpcds_1.store_sales, tpcds_1.item\n where d_date_sk = ss_sold_date_sk\n \tand ss_item_sk = i_item_sk\n \tand i_manager_id=36\n \tand d_moy=12\n \tand d_year=2001\n group by i_brand, i_brand_id\n order by ext_price desc, i_brand_id\nLIMIT 100 ;"}, {"id": "39", "start_time": "2023-03-27T15:54:20.610327+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "89", "start_time": "2023-03-27T15:54:22.700541+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "55", "start_time": "2023-03-27T15:55:31.163813+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "69", "start_time": "2023-03-27T15:55:38.502269+00:00", "text": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from tpcds_1.customer, tpcds_1.customer_address, tpcds_1.customer_demographics, tpcds_1.household_demographics, tpcds_1.income_band, tpcds_1.store_returns\n where ca_city\t        =  'Hopewell'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  32287\n   and ib_upper_bound   <=  32287 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n LIMIT 100;"}, {"id": "99", "start_time": "2023-03-27T15:56:23.359415+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "100", "start_time": "2023-03-27T15:56:42.740467+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "60", "start_time": "2023-03-27T15:58:40.389856+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "152", "start_time": "2023-03-27T15:58:41.799144+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "61", "start_time": "2023-03-27T15:58:42.950385+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "25", "start_time": "2023-03-27T15:58:44.998998+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "32", "start_time": "2023-03-27T15:58:46.810220+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "17", "start_time": "2023-03-27T15:58:48.583189+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "155", "start_time": "2023-03-27T15:58:50.169268+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "56", "start_time": "2023-03-27T15:58:51.580392+00:00", "text": "select  count(*) \nfrom tpcds_1.store_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.store\nwhere ss_sold_time_sk = time_dim.t_time_sk   \n    and ss_hdemo_sk = household_demographics.hd_demo_sk \n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\nLIMIT 100;"}, {"id": "7", "start_time": "2023-03-27T15:58:55.003705+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}, {"id": "40", "start_time": "2023-03-27T15:59:22.745469+00:00", "text": "select  cast(amc as float64)/cast(pmc as float64) am_pm_ratio\n from ( select count(*) amc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 6 and 6+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) ,\n      ( select count(*) pmc\n       from tpcds_1.web_sales, tpcds_1.household_demographics, tpcds_1.time_dim, tpcds_1.web_page\n       where ws_sold_time_sk = time_dim.t_time_sk\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n         and ws_web_page_sk = web_page.wp_web_page_sk\n         and time_dim.t_hour between 14 and 14+1\n         and household_demographics.hd_dep_count = 8\n         and web_page.wp_char_count between 5000 and 5200) pt\n order by am_pm_ratio\n LIMIT 100;"}]}